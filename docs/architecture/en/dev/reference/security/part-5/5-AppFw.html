<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
    <meta name="description" content=" ">

    <title>
	    AGL Developer Site - 
        
            
                Application Framework  -
            
        
    </title>

    <link rel="SHORTCUT ICON" href="/favicon.ico"/>

    

    
    

    <link rel="canonical" href="http://docs.automotivelinux.org/docs/architecture/en/dev/reference/security/part-5/5-AppFw.html">

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="/static/styles/main.css">
    <link rel="stylesheet" type="text/css" href="/static/styles/syntax.css">
    <!-- Algolia Search CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />

    <!-- Fonts -->
    <!-- For attribution information, see www/attributions.html -->
    <link href='https://fonts.googleapis.com/css?family=Raleway:700,400,300,700italic,400italic,300italic' rel='stylesheet' type='text/css'>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- <script defer type="text/javascript">
        var disqus_developer = ; // this would set it to developer mode
    </script>-->

    <!-- JS -->
    <script defer type="text/javascript" src="/static/js/lib/jquery-2.1.1.min.js"></script>
    <script defer type="text/javascript" src="/static/js/lib/bootstrap.min.js"></script>
<!--    <script defer type="text/javascript" src="/static/js/lib/ZeroClipboard.js"></script>-->

    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', '{}', 'auto');
    ga('send', 'pageview');
</script>

</head>

<body>
    <header>
    <a class="scroll-point pt-top" name="top"></a>
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" href="/"><img id="logo_top" src="/static/img/branding/agl_title_793x211.png"/></a>
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <div class="nav_bar_left">
                    <ul class="nav navbar-nav">
                        <li >
                            <a href="/docs/getting_started/en/dev/">Getting Started</a>
                        </li>
                                                
                        <li >
                            <a href="/docs/architecture/en/dev/">Architecture Guides</a>
                        </li>

                        <li >
                            <a href="/docs/hardware/en/dev/">Hardware Support</a>
                        </li>

                        <li >
                            <a href="/docs/devguides/en/dev/">Developer Guides</a>
                        </li>
                        
                        <li >
                            <a href="/docs/apis_services/en/dev/">APIs & Services</a>
                        </li>
					</ul>
				</div>
                <div class="nav_bar_right">
                    <ul class="nav navbar-nav">
                        <li >
                            <a href="/techpost" id="blog_button">TechPost<span class="badge" id="new_blog_count"></span></a>
                        </li>
                        <li >
                            <a href="/contribute">Contribute</a>
                        </li>
                        <li>
                            <form class="navbar-form navbar-right" id="header-search-form" role="search">
                                <div class="input-group">
                                    
                                    <input id="header-search-field" type="text" placeholder="Search 'dev' docs..." class="form-control hidden-xs" autocomplete="off">
                                </div>
                            </form>
                        </li>
                    </ul>
                </div>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    <div id="_fixed_navbar_spacer" style="padding-top:50px"></div>
</header>














<div class="docs container">

    <!-- Table of Contents -->
    <div class="hidden-xs hidden-sm col-md-4 col-lg-3 site-toc-container">
        <ul class="site-toc">
    

    <li>
        
            <span class="toc-section-heading">
                AGL Specifications
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/AGL_Specifications/agl_spec_v1.0_final.pdf">
                Automotive Grade Linux Requirements Specifications
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Security Blueprint
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/README.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Part-1 Hardware
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-1/0_Abstract.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Part-2 Secure Boot
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-2/0_Abstract.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-2/1-Image.html">
                Image
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-2/2-Communication-modes.html">
                Communication modes
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-2/3-Consoles.html">
                Consoles
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Part-3 Hypervisor
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-3/0_Abstract.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Part-4 Kernel
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-4/0_Abstract.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-4/1-General.html">
                General
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-4/2-Memory.html">
                Memory
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-4/3-Consoles.html">
                Consoles
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-4/4-Debug.html">
                Debug
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-4/5-FileSystems.html">
                File Systems
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Part-5 Platform
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-5/0_Abstract.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-5/1-MAC.html">
                Mandatory Access Control
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-5/2-SystemD.html">
                SystemD
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-5/3-SystemBus.html">
                SystemBus
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-5/4-Services.html">
                System services and daemons
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="this-page" href="/docs/architecture/en/dev/reference/security/part-5/5-AppFw.html">
                Application Framework
            </a>
            
                <span class="entry-highlight"></span>
            
        

        
        <div id="page-toc" class="page-toc"></div>

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-5/6-Utilities.html">
                Utilities
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-5/7-Users.html">
                Users
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Part-6 Application
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-6/0_Abstract.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-6/1-Installation.html">
                Installation
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-6/2-PrivilegeManagement.html">
                Privilege management
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-6/3-Signature.html">
                Signature
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-6/4-Services.html">
                Services
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Part-7 Connectivity
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-7/0_Abstract.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-7/1-BusAndConnectors.html">
                Bus and connectors
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-7/2-Wireless.html">
                Wireless
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-7/3-Cloud.html">
                Cloud
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Part-8 Update
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-8/0_Abstract.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-8/1-FOTA.html">
                FOTA
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-8/2-SOTA.html">
                SOTA
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Part-9 Secure development
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-9/0_Abstract.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Annexes
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/annexes/0_Abstract.html">
                Annexes
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/annexes/ConfigNotes.html">
                Config notes
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/annexes/todoNotes.html">
                Todo notes
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    
</ul>

        
    </li>
    
</ul>

    </div>

    <!-- Page content -->
    <div class="col-md-8 col-md-offset-4 col-lg-9 col-lg-offset-3 page-content-container container">
        <div class="page-content row">
            <div class="col-md-offset-1 col-md-10">
                <div class="content-header">

                    <!-- ToC Dropdown (for XS and SM sizes only) -->
                    <div class="toc-dropdown dropdown visible-xs-block visible-sm-block">
                        <button class="btn btn-default dropdown-toggle" type="button" id="tocDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                            Table of Contents
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu">
                            






<li>
    <a class="" href="reference/AGL_Specifications/agl_spec_v1.0_final.pdf">
        Automotive Grade Linux Requirements Specifications
    </a>
</li>











<li>
    <a class="" href="reference/security/README.html">
        Introduction
    </a>
</li>








<li>
    <a class="" href="reference/security/part-1/0_Abstract.html">
        Introduction
    </a>
</li>











<li>
    <a class="" href="reference/security/part-2/0_Abstract.html">
        Introduction
    </a>
</li>




<li>
    <a class="" href="reference/security/part-2/1-Image.html">
        Image
    </a>
</li>




<li>
    <a class="" href="reference/security/part-2/2-Communication-modes.html">
        Communication modes
    </a>
</li>




<li>
    <a class="" href="reference/security/part-2/3-Consoles.html">
        Consoles
    </a>
</li>











<li>
    <a class="" href="reference/security/part-3/0_Abstract.html">
        Introduction
    </a>
</li>











<li>
    <a class="" href="reference/security/part-4/0_Abstract.html">
        Introduction
    </a>
</li>




<li>
    <a class="" href="reference/security/part-4/1-General.html">
        General
    </a>
</li>




<li>
    <a class="" href="reference/security/part-4/2-Memory.html">
        Memory
    </a>
</li>




<li>
    <a class="" href="reference/security/part-4/3-Consoles.html">
        Consoles
    </a>
</li>




<li>
    <a class="" href="reference/security/part-4/4-Debug.html">
        Debug
    </a>
</li>




<li>
    <a class="" href="reference/security/part-4/5-FileSystems.html">
        File Systems
    </a>
</li>











<li>
    <a class="" href="reference/security/part-5/0_Abstract.html">
        Introduction
    </a>
</li>




<li>
    <a class="" href="reference/security/part-5/1-MAC.html">
        Mandatory Access Control
    </a>
</li>




<li>
    <a class="" href="reference/security/part-5/2-SystemD.html">
        SystemD
    </a>
</li>




<li>
    <a class="" href="reference/security/part-5/3-SystemBus.html">
        SystemBus
    </a>
</li>




<li>
    <a class="" href="reference/security/part-5/4-Services.html">
        System services and daemons
    </a>
</li>




<li>
    <a class="this-page" href="reference/security/part-5/5-AppFw.html">
        Application Framework
    </a>
</li>




<li>
    <a class="" href="reference/security/part-5/6-Utilities.html">
        Utilities
    </a>
</li>




<li>
    <a class="" href="reference/security/part-5/7-Users.html">
        Users
    </a>
</li>











<li>
    <a class="" href="reference/security/part-6/0_Abstract.html">
        Introduction
    </a>
</li>




<li>
    <a class="" href="reference/security/part-6/1-Installation.html">
        Installation
    </a>
</li>




<li>
    <a class="" href="reference/security/part-6/2-PrivilegeManagement.html">
        Privilege management
    </a>
</li>




<li>
    <a class="" href="reference/security/part-6/3-Signature.html">
        Signature
    </a>
</li>




<li>
    <a class="" href="reference/security/part-6/4-Services.html">
        Services
    </a>
</li>











<li>
    <a class="" href="reference/security/part-7/0_Abstract.html">
        Introduction
    </a>
</li>




<li>
    <a class="" href="reference/security/part-7/1-BusAndConnectors.html">
        Bus and connectors
    </a>
</li>




<li>
    <a class="" href="reference/security/part-7/2-Wireless.html">
        Wireless
    </a>
</li>




<li>
    <a class="" href="reference/security/part-7/3-Cloud.html">
        Cloud
    </a>
</li>











<li>
    <a class="" href="reference/security/part-8/0_Abstract.html">
        Introduction
    </a>
</li>




<li>
    <a class="" href="reference/security/part-8/1-FOTA.html">
        FOTA
    </a>
</li>




<li>
    <a class="" href="reference/security/part-8/2-SOTA.html">
        SOTA
    </a>
</li>











<li>
    <a class="" href="reference/security/part-9/0_Abstract.html">
        Introduction
    </a>
</li>











<li>
    <a class="" href="reference/security/annexes/0_Abstract.html">
        Annexes
    </a>
</li>




<li>
    <a class="" href="reference/security/annexes/ConfigNotes.html">
        Config notes
    </a>
</li>




<li>
    <a class="" href="reference/security/annexes/todoNotes.html">
        Todo notes
    </a>
</li>










                        </ul>
                    </div>

                    <!--
                    
                    
                        <a class="edit" href="https://github.com/automotive-grade-linux/docs-agl/edit/master/docs/security-blueprint/part-5/5-AppFw.md"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> Edit</a>

                    
                    
                    -->

                    <!-- Language dropdown -->
                    <!--
                    <div class="dropdown">
                        <button class="btn btn-default dropdown-toggle" type="button" id="languageDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                            
                            <span class="caret"></span>
                        </button>

                        <!-- List all languages - ->
                        <ul class="dropdown-menu" aria-labelledby="languageDropdown">
                            
                        </ul>
                    </div>
                    -->

                    <!-- Version dropdown -->
                    <!--
                    <div class="dropdown">
                        <button class="btn btn-default dropdown-toggle" type="button" id="versionDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                            dev
                            
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" aria-labelledby="versionDropdown">

                            <!-- List versions available in this language - ->
                            
                        </ul>
                    </div>
                    -->
                </div>
                

                
                
                

                
                

                <!-- Show warnings for special versions -->
                <!-- dev warning
                
                    <div class="alert docs-alert alert-info" role="alert">
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        Draft version of documentation under development may change!
                        <a href="/docs/en/latest/">
                            Click here for the latest released version.
                        </a>
                    </div>
                
                -->

                <!-- outdated warning
                
                -->


                <div id="page-toc-source">
                    <!-- WARNING: This file is generated by fetch_docs.js using /w/workspace/sandbox-doc-update/webdocs-agl/content/tocs/architecture/fetched_files.yml -->

<h1 id="application-frameworkmodel-appfw">Application framework/model (<strong>AppFw</strong>)</h1>

<p>The AGL application framework consists of several inter-working parts:</p>

<ul>
  <li><strong>SMACK</strong>: The kernel level <strong>LSM</strong> (<strong>L</strong>inux <strong>S</strong>ecurity <strong>M</strong>odule) that performs extended access control of the system.</li>
  <li><strong>Cynara</strong>: the native gatekeeper daemon used for policy handling, updating to the database and policy checking.</li>
  <li>Security Manager: a master service, through which all security events are intended to take place.</li>
  <li>Several native application framework utilities: <code class="highlighter-rouge">afm-main-binding</code>, <code class="highlighter-rouge">afm-user-daemon</code>, <code class="highlighter-rouge">afm-system-daemon</code>.</li>
</ul>

<p>The application framework manages:</p>

<ul>
  <li>The applications and services management: Installing, Uninstalling, Listing, …</li>
  <li>The life cycle of applications: Start -&gt; (Pause, Resume) -&gt; Stop.</li>
  <li>Events and signals propagation.</li>
  <li>Privileges granting and checking.</li>
  <li>API for interaction with applications.</li>
</ul>

<!-- section-note -->

<ul>
  <li>
    <p>The <strong>security model</strong> refers to the security model used to ensure security
and to the tools that are provided for implementing that model. It’s an
implementation detail that should not impact the layers above the application
framework.</p>
  </li>
  <li>
    <p>The <strong>security model</strong> refers to how <strong>DAC</strong> (<strong>D</strong>iscretionary <strong>A</strong>ccess <strong>C</strong>ontrol),
<strong>MAC</strong> (Mandatory Access Control) and <code class="highlighter-rouge">Capabilities</code> are used by the system to
ensure security and privacy. It also includes features of reporting using
audit features and by managing logs and alerts.</p>
  </li>
</ul>

<!-- end-section-note -->

<p>The <strong>AppFw</strong> uses the security model to ensure the security and the privacy of
the applications that it manages. It must be compliant with the underlying
security model. But it should hide it to the applications.</p>

<!-- section-config -->

<table>
  <thead>
    <tr>
      <th>Domain</th>
      <th>Object</th>
      <th>Recommendations</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Platform-AGLFw-AppFw-1</td>
      <td>Security model</td>
      <td>Use the AppFw as Security model.</td>
    </tr>
  </tbody>
</table>

<!-- end-section-config -->

<p>See <a href="http://docs.automotivelinux.org/docs/devguides/en/dev/reference/iotbzh2016/appfw/03-AGL-AppFW-Privileges-Management.pdf">AGL AppFw Privileges Management</a> and <a href="http://iot.bzh/download/public/2017/SDK/AppFw-Documentation-v3.1.pdf">AGL - Application Framework Documentation</a> for more
information.</p>

<!-- pagebreak -->

<p>The Security Manager communicates policy information to <strong>Cynara</strong>,
which retains information in its own database in the format of a text
file with comma-separated values (CSV). There are provisions to retain
a copy of the CSV text file when the file is being updated.</p>

<p>Runtime checking occurs through <strong>Cynara</strong>. Each application that is
added to the framework has its own instantiation of a SMACK context
and D-bus bindings. The afb_daemon and Binder form a web-service that
is communicated to through http or a websocket from the application-proper.
This http or websocket interface uses a standard unique web token for API communication.</p>

<p><img src="App-flow.png" alt="Application Framework Flow" /></p>

<h2 id="cynara">Cynara</h2>

<p>There’s a need for another mechanism responsible for checking applicative
permissions: Currently in AGL, this task depends on a policy-checker service
(<strong>Cynara</strong>).</p>

<ul>
  <li>Stores complex policies in databases.</li>
  <li>“Soft” security (access is checked by the framework).</li>
</ul>

<p>Cynara interact with <strong>D-Bus</strong> in order to deliver this information.</p>

<p>Cynara consists of several parts:</p>

<ul>
  <li>Cynara: a daemon for controlling policies and responding to access control requests.</li>
  <li>Database: a spot to hold policies.</li>
  <li>Libraries: several static and dynamic libraries for communicating with Cynara.</li>
</ul>

<p>The daemon communicates to the libraries over Unix domain sockets.
The database storage format is a series of CSV-like files with an index file.</p>

<p>There are several ways that an attacker can manipulate policies of the Cynara system:</p>

<ul>
  <li>Disable Cynara by killing the process.</li>
  <li>Tamper with the Cynara binary on-disk or in-memory.</li>
  <li>Corrupt the database controlled by Cynara.</li>
  <li>Tamper with the database controlled by Cynara.</li>
  <li>Highjack the communication between Cynara and the database.</li>
</ul>

<p>The text-based database is the weakest part of the system and although there are some
consistency mechanisms in place (i.e. the backup guard), these mechanisms are weak at best
and can be countered by an attacker very easily.</p>

<!-- section-config -->

<table>
  <thead>
    <tr>
      <th>Domain</th>
      <th>Object</th>
      <th>Recommendations</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Platform-AGLFw-Cynara-1</td>
      <td>Permissions</td>
      <td>Use Cynara as policy-checker service.</td>
    </tr>
  </tbody>
</table>

<!-- end-section-config -->

<h3 id="policies">Policies</h3>

<ul>
  <li>
    <p>Policy rules:</p>

    <ul>
      <li>Are simple - for pair [application context, privilege] there is straight
answer (single Policy Type): [ALLOW / DENY / …].</li>
      <li>No code is executed (no script).</li>
      <li>Can be easily cached and managed.</li>
    </ul>
  </li>
  <li>
    <p>Application context (describes id of the user and the application credentials)
It is build of:</p>

    <ul>
      <li>UID of the user that runs the application.</li>
      <li><strong>SMACK</strong> label of application.</li>
    </ul>
  </li>
</ul>

<h2 id="holding-policies">Holding policies</h2>

<p>Policies are kept in buckets. Buckets are set of policies which have additional
a property of default answer, the default answer is yielded if no policy matches
searched key. Buckets have names which might be used in policies (for directions).</p>

<h2 id="attack-vectors">Attack Vectors</h2>

<p>The following attack vectors are not completely independent. While attackers may
have varying levels of access to an AGL system, experience has shown that a typical
attack can start with direct access to a system, find the vulnerabilities,
then proceed to automate the attack such that it can be invoked from less accessible
standpoint (e.g. remotely). Therefore, it is important to assess all threat levels,
and protect the system appropriately understanding that direct access attacks
are the door-way into remote attacks.</p>

<h3 id="remote-attacks">Remote Attacks</h3>

<p>The local web server interface used for applications is the first point of attack,
as web service APIs are well understood and easily intercepted. The local web server
could potentially be exploited by redirecting web requests through the local service
and exploiting the APIs. While there is the use of a security token on the web
service API, this is weak textual matching at best. This will not be difficult to spoof.
It is well known that <a href="http://nordicapis.com/why-api-keys-are-not-enough/">API Keys do not provide any real security</a>.</p>

<p>It is likely that the architectural inclusion of an http / web-service interface
provided the most flexibility for applications to be written natively or in HTML5.
However, this flexibility may trade-off with security concerns. For example,
if a native application were linked directly to the underlying framework services,
there would be fewer concerns over remote attacks coming through the web-service interface.</p>

<p>Leaving the interface as designed, mitigations to attacks could include further
securing the interface layer with cryptographic protocols:
e.g. encrypted information passing, key exchange (e.g. Elliptic-Curve Diffie-Hellman).</p>

<h3 id="user-level-native-attacks">User-level Native Attacks</h3>

<ul>
  <li>Modifying the CSV data-base</li>
  <li>Modifying the SQLite DB</li>
  <li>Tampering with the user-level binaries</li>
  <li>Tampering with the user daemons</li>
  <li>Spoofing the D-bus Interface</li>
  <li>Adding executables/libraries</li>
</ul>

<p>With direct access to the device, there are many security concerns on the native level.
For example, as <strong>Cynara</strong> uses a text file data-base with comma-separated values (CSV),
an attacker could simply modify the data-base to escalate privileges of an application.
Once a single application has all the privileges possible on the system, exploits can
come through in this manner. Similarly the SQLite database used by the Security Manager
is not much different than a simple text file. There are many tools available to add,
remove, modify entries in an SQLite data-base.</p>

<p>On the next level, a common point of attack is to modify binaries or daemons for exploiting
functionality. There are many Linux tools available to aid in this regard,
including: <a href="https://www.hex-rays.com/products/ida/index.shtml">IDA Pro</a>,
and <a href="https://rada.re/r/">radare2</a>. With the ability to modify binaries,
an attacker can do any number of activities including: removing calls to security checks,
redirecting control to bypass verification functionality, ignoring security policy handling,
escalating privileges, etc.</p>

<p>Additionally, another attack vector would be to spoof the D-bus interface. D-bus is a
message passing system built upon Inter-Process Communication (IPC), where structured
messages are passed based upon a protocol. The interface is generic and well documented.
Therefore, modifying or adding binaries/libraries to spoof this interface is a relatively
straight-forward process. Once the interface has been spoofed, the attacker can issue any
number of commands that lead into control of low-level functionality.</p>

<p>Protecting a system from native attacks requires a methodical approach. First, the system
should reject processes that are not sanctioned to run. Signature-level verification at
installation time will help in this regard, but run-time integrity verification is much better.
Signatures need to originate from authorized parties, which is discussed further
in a later section on the Application Store.</p>

<p>On the next level, executables should not be allowed to do things where they have not been
granted permission. DAC and SMACK policies can help in this regard. On the other hand,
there remain concerns with memory accesses, system calls, and other process activity
that may go undetected. For this reason, a secure environment which monitors all activity
can give indication of all unauthorized activity on the system.</p>

<p>Finally, it is very difficult to catch attacks of direct tampering in a system.
These types of attacks require a defense-in-depth approach, where complementary software
protection and hardening techniques are needed. Tamper-resistance and anti-reverse-engineering
technologies include program transformations/obfuscation, integrity verification,
and white-box cryptography. If applied in a mutually-dependent fashion and considering
performance/security tradeoffs, the approach can provide an effective barrier
to direct attacks to the system. Furthermore, the use of threat monitoring provides a
valuable telemetry/analytics capability and the ability to react and renew a system under attack.</p>

<h3 id="root-level-native-attacks">Root-level Native Attacks</h3>

<ul>
  <li>Tampering the system daemon</li>
  <li>Tampering Cynara</li>
  <li>Tampering the security manager</li>
  <li>Disabling SMACK</li>
  <li>Tampering the kernel</li>
</ul>

<p>Once root-level access (i.e. su) has been achieved on the device, there are many ways
to compromise the system. The system daemon, <strong>Cynara</strong>, and the security manager are
vulnerable to tampering attacks. For example, an executable can be modified in memory
to jam a branch, jump to an address, or disregard a check. This can be as simple as replacing
a branch instruction with a NOP, changing a memory value, or using a debugger (e.g. gdb, IDA)
to change an instruction. Tampering these executables would mean that policies can be
ignored and verification checks can be bypassed.</p>

<p>Without going so far as to tamper an executable, the <strong>SMACK</strong> system is also vulnerable to attack.
For example, if the kernel is stopped and restarted with the <em>security=none</em> flag,
then SMACK is not enabled. Furthermore, <code class="highlighter-rouge">systemd</code> starts the loading of <strong>SMACK</strong> rules during
start-up. If this start-up process is interfered with, then <strong>SMACK</strong> will not run.
Alternatively, new policies can be added with <code class="highlighter-rouge">smackload</code> allowing unforseen privileges
to alternative applications/executables.</p>

<p>Another intrusion on the kernel level is to rebuild the kernel (as it is open-source)
and replace it with a copy that has <strong>SMACK</strong> disabled, or even just the <strong>SMACK</strong> filesystem
(<code class="highlighter-rouge">smackfs</code>) disabled. Without the extended label attributes, the <strong>SMACK</strong> system is disabled.</p>

<p>Root-level access to the device has ultimate power, where the entire system can be compromised.
More so, a system with this level access allows an attacker to craft a simpler <em>point-attack</em>
which can operate on a level requiring fewer privileges (e.g. remote access, user-level access).</p>

<h2 id="vulnerable-resources">Vulnerable Resources</h2>

<h3 id="resource-afm-user-daemon">Resource: <code class="highlighter-rouge">afm-user-daemon</code></h3>

<p>The <code class="highlighter-rouge">afm-user-daemon</code> is in charge of handling applications on behalf of a user. Its main tasks are:</p>

<ul>
  <li>Enumerate applications that the end user can run and keep this list available on demand.</li>
  <li>Start applications on behalf of the end user, set user running environment, set user security context.</li>
  <li>List current runnable or running applications.</li>
  <li>Stop (aka pause), continue (aka resume), terminate a running instance of a given application.</li>
  <li>Transfer requests for installation/uninstallation of applications to the corresponding system daemon afm-system-daemon.</li>
</ul>

<p>The <code class="highlighter-rouge">afm-user-daemon</code> launches applications. It builds a secure environment for the application
before starting it within that environment. Different kinds of applications can be launched,
based on a configuration file that describes how to launch an application of a given kind within
a given launching mode: local or remote. Launching an application locally means that
the application and its binder are launched together. Launching an application remotely
translates in only launching the application binder.</p>

<p>The UI by itself has to be activated remotely by a request (i.e. HTML5 homescreen in a browser).
Once launched, running instances of the application receive a <code class="highlighter-rouge">runid</code> that identifies them.
<code class="highlighter-rouge">afm-user-daemon</code> manages the list of applications that it has launched.
When owning the right permissions, a client can get the list of running instances and details
about a specific running instance. It can also terminate, stop or continue a given application.
If the client owns the right permissions, <code class="highlighter-rouge">afm-user-daemon</code> delegates the task of
installing and uninstalling applications to <code class="highlighter-rouge">afm-system-daemon</code>.</p>

<p><code class="highlighter-rouge">afm-user-daemon</code> is launched as a <code class="highlighter-rouge">systemd</code> service attached to a user session.
Normally, the service file is located at /usr/lib/systemd/user/afm-user-daemon.service.</p>

<p>Attacker goals:</p>

<ul>
  <li>Disable <code class="highlighter-rouge">afm-user-daemon</code>.</li>
  <li>Tamper with the <code class="highlighter-rouge">afm-user-daemon</code> configuration.
    <ul>
      <li>/usr/lib/systemd/user/afm-user-daemon.service.</li>
      <li>Application(widget) config.xml file.</li>
      <li>/etc/afm/afm-launch.conf (launcher configuration).</li>
    </ul>
  </li>
  <li>Escalate user privileges to gain more access with <code class="highlighter-rouge">afm-user-daemon</code>.</li>
  <li>Install malicious application (widget).</li>
  <li>Tamper with <code class="highlighter-rouge">afm-user-daemon</code> on disk or in memory.</li>
</ul>

<h3 id="resource-afm-system-daemon">Resource: <code class="highlighter-rouge">afm-system-daemon</code></h3>

<p>The <code class="highlighter-rouge">afm-system-daemon</code> is in charge of installing applications on the AGL system. Its main tasks are:</p>

<ul>
  <li>Install applications and setup security framework for newly installed applications.</li>
  <li>Uninstall applications.</li>
</ul>

<p><code class="highlighter-rouge">afm-system-daemon</code> is launched as a <code class="highlighter-rouge">systemd</code> service attached to system. Normally,
the service file is located at /lib/systemd/system/afm-systemdaemon.service.</p>

<p>Attacker goals:</p>

<ul>
  <li>Disable <code class="highlighter-rouge">afm-system-daemon</code>.</li>
  <li>Tamper with the <code class="highlighter-rouge">afm-system-daemon</code> configuration.</li>
  <li>Tamper <code class="highlighter-rouge">afm-system-daemon</code> on disk or in memory.</li>
</ul>

<h3 id="resource-afb-daemon">Resource <code class="highlighter-rouge">afb-daemon</code></h3>

<p><code class="highlighter-rouge">afb-binder</code> is in charge of serving resources and features through an HTTP interface.
<code class="highlighter-rouge">afb-daemon</code> is in charge of binding one instance of an application to the AGL framework
and AGL system. The application and its companion binder run in a secured and isolated
environment set for them. Applications are intended to access to AGL system through the binder.
<code class="highlighter-rouge">afb-daemon</code> binders serve files through HTTP protocol and offers developers the capability
to expose application API methods through HTTP or WebSocket protocol.</p>

<p>Binder bindings are used to add APIs to <code class="highlighter-rouge">afb-daemon</code>. The user can write a binding for <code class="highlighter-rouge">afb-daemon</code>.
The binder <code class="highlighter-rouge">afb-daemon</code> serves multiple purposes:</p>

<ol>
  <li>It acts as a gateway for the application to access the system.</li>
  <li>It acts as an HTTP server for serving files to HTML5 applications.</li>
  <li>It allows HTML5 applications to have native extensions subject to security enforcement for accessing hardware resources or for speeding up parts of algorithm.</li>
</ol>

<p>Attacker goals:</p>

<ul>
  <li>Break from isolation.</li>
  <li>Disable <code class="highlighter-rouge">afb-daemon</code>.</li>
  <li>Tamper <code class="highlighter-rouge">afb-demon</code> on disk or in memory.</li>
  <li>Tamper <strong>capabilities</strong> by creating/installing custom bindings for <code class="highlighter-rouge">afb-daemon</code>.</li>
</ul>



                </div>
            </div>
        </div>
        <div class="row">
            <div class="blue-divider"></div>
<footer>
    <div class="container-fluid">
        <div class="row">
    <div class="col-sm-9">
        <h1>More Resources</h1>
        <div class="row">
            <div class="col-sm-4">
                <h2>General</h2>
                <ul class="nav">
                    <li>
                        <a target="_blank" href="https://www.automotivelinux.org/">AGL Developer Community</a>
                    </li>
                    <li>
                        <a href="https://www.automotivelinux.org/software/download/">Download Distribution</a>
                    </li>
                    <li>
                        <a href="https://gerrit.automotivelinux.org/gerrit/#/admin/projects/">Source Code on Git</a>
                    </li>
                    <li>
                        <a target="_blank" href="/contact">Mailing List</a>
                    </li>
                </ul>
            </div>
            <div class="col-sm-4">
                <h2>Development</h2>
                <ul class="nav">
                    <li><a target="_blank" href="https://wiki.automotivelinux.org/agl-distro/source-code">Source Code</a></li>
                    <li><a target="_blank" href="https://jira.automotivelinux.org/browse/SPEC/?selectedTab=com.atlassian.jira.jira-projects-plugin:summary-panel">Issue Tracker</a></li>
                    <li><a target="_blank" href="https://wiki.automotivelinux.org/">Wiki</a></li>
                    <li><a href="https://www.automotivelinux.org/contact-us">Contact</a></li>
                </ul>
            </div>
            <div class="col-sm-4">
                <h2>Automotive Grade Linux @ Linux Foundation</h2>
                <ul class="nav">
                    <li>
                        <a target="_blank" href="https://www.automotivelinux.org/">About AGL</a>
                    </li>
                    <li>
                        <a target="_blank" href="http://www.linuxfoundation.org/">About Linux Foundation</a>
                    </li>
                    <li>
                        <a target="_blank" href="https://wiki.automotivelinux.org/start/getting-started">Join AGL community</a>
                    </li>
                    <li>
                        <a target="_blank" href="https://www.automotivelinux.org/about/members">Members</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="col-sm-3">
        <h1>Contribute</h1>
        <p style="padding-top:20px"><strong>Help AGL move forward!</strong></p>
        <p>Report bugs, improve the docs, or contribute to the code.</p>
        <a href="/contribute" class="btn btn-lg btn-primary">
            Learn More
        </a>
        <p style="padding-top:20px"> <a href="https://twitter.com/autogradelinux" class="twitter-follow-button" data-show-count="false">Follow @autogradelinux</a></p>
    </div>
</div>
<div class="row">
	<div class="col-sm-9">
		<p class="copyright_text">
			Copyright &copy; 2015-2018 Automotive Grade Linux Documentation, Licensed under the <a target="_blank" href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
			<br/>
			Automotive Grade Linux and logos are <a target="_blank" href="http://www.linuxfoundation.org">trademarks</a> of The Linux Foundation.
			<br/>
			Initial site design from <a href="https://cordova.apache.org/">Cordova website.</a> - warm thanks !
		</p>
	</div>
    <div class="col-sm-3">
		<small class="stats">Page rendered at:  2018-07-30 00:01:40 +0000</small>
		
		<br/><small class="stats"><a href="https://raw.githubusercontent.com/automotive-grade-linux/docs-agl/master/docs/security-blueprint/part-5/5-AppFw.md">Link to source document</small>
		
	</div>
</div>

    </div>
</footer>

        </div>
    </div>
</div>

<script defer type="text/javascript" src="/static/js/lib/toc.min.js"></script>
<script defer type="text/javascript" src="/static/js/docs.js"></script>

    <script defer type="text/javascript" src="/static/js/twitter.js"></script>
    



<script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
<script type="text/javascript">
    docsearch({
        apiKey: 'edd30bcff9f6df4b095c41cba3e5a418',
        indexName: 'automotivelinux',
        inputSelector: '#header-search-field',
    });
</script>

            
    

</body>
</html>
