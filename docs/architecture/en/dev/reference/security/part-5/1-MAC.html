<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
    <meta name="description" content=" ">

    <title>
	    AGL Developer Site - 
        
            
                Mandatory Access Control  -
            
        
    </title>

    <link rel="SHORTCUT ICON" href="/favicon.ico"/>

    

    
    

    <link rel="canonical" href="http://docs.automotivelinux.org/docs/architecture/en/dev/reference/security/part-5/1-MAC.html">

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="/static/styles/main.css">
    <link rel="stylesheet" type="text/css" href="/static/styles/syntax.css">
    <!-- Algolia Search CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />

    <!-- Fonts -->
    <!-- For attribution information, see www/attributions.html -->
    <link href='https://fonts.googleapis.com/css?family=Raleway:700,400,300,700italic,400italic,300italic' rel='stylesheet' type='text/css'>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- <script defer type="text/javascript">
        var disqus_developer = ; // this would set it to developer mode
    </script>-->

    <!-- JS -->
    <script defer type="text/javascript" src="/static/js/lib/jquery-2.1.1.min.js"></script>
    <script defer type="text/javascript" src="/static/js/lib/bootstrap.min.js"></script>
<!--    <script defer type="text/javascript" src="/static/js/lib/ZeroClipboard.js"></script>-->

    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', '{}', 'auto');
    ga('send', 'pageview');
</script>

</head>

<body>
    <header>
    <a class="scroll-point pt-top" name="top"></a>
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" href="/"><img id="logo_top" src="/static/img/branding/agl_title_793x211.png"/></a>
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <div class="nav_bar_left">
                    <ul class="nav navbar-nav">
                        <li >
                            <a href="/docs/getting_started/en/dev/">Getting Started</a>
                        </li>
                                                
                        <li >
                            <a href="/docs/architecture/en/dev/">Architecture Guides</a>
                        </li>

                        <li >
                            <a href="/docs/hardware/en/dev/">Hardware Support</a>
                        </li>

                        <li >
                            <a href="/docs/devguides/en/dev/">Developer Guides</a>
                        </li>
                        
                        <li >
                            <a href="/docs/apis_services/en/dev/">APIs & Services</a>
                        </li>
					</ul>
				</div>
                <div class="nav_bar_right">
                    <ul class="nav navbar-nav">
                        <li >
                            <a href="/techpost" id="blog_button">TechPost<span class="badge" id="new_blog_count"></span></a>
                        </li>
                        <li >
                            <a href="/contribute">Contribute</a>
                        </li>
                        <li>
                            <form class="navbar-form navbar-right" id="header-search-form" role="search">
                                <div class="input-group">
                                    
                                    <input id="header-search-field" type="text" placeholder="Search 'dev' docs..." class="form-control hidden-xs" autocomplete="off">
                                </div>
                            </form>
                        </li>
                    </ul>
                </div>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    <div id="_fixed_navbar_spacer" style="padding-top:50px"></div>
</header>














<div class="docs container">

    <!-- Table of Contents -->
    <div class="hidden-xs hidden-sm col-md-4 col-lg-3 site-toc-container">
        <ul class="site-toc">
    

    <li>
        
            <span class="toc-section-heading">
                AGL Specifications
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/AGL_Specifications/agl_spec_v1.0_final.pdf">
                Automotive Grade Linux Requirements Specifications
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Security Blueprint
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/README.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Part-1 Hardware
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-1/0_Abstract.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Part-2 Secure Boot
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-2/0_Abstract.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-2/1-Image.html">
                Image
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-2/2-Communication-modes.html">
                Communication modes
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-2/3-Consoles.html">
                Consoles
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Part-3 Hypervisor
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-3/0_Abstract.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Part-4 Kernel
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-4/0_Abstract.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-4/1-General.html">
                General
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-4/2-Memory.html">
                Memory
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-4/3-Consoles.html">
                Consoles
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-4/4-Debug.html">
                Debug
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-4/5-FileSystems.html">
                File Systems
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Part-5 Platform
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-5/0_Abstract.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="this-page" href="/docs/architecture/en/dev/reference/security/part-5/1-MAC.html">
                Mandatory Access Control
            </a>
            
                <span class="entry-highlight"></span>
            
        

        
        <div id="page-toc" class="page-toc"></div>

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-5/2-SystemD.html">
                SystemD
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-5/3-SystemBus.html">
                SystemBus
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-5/4-Services.html">
                System services and daemons
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-5/5-AppFw.html">
                Application Framework
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-5/6-Utilities.html">
                Utilities
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-5/7-Users.html">
                Users
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Part-6 Application
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-6/0_Abstract.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-6/1-Installation.html">
                Installation
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-6/2-PrivilegeManagement.html">
                Privilege management
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-6/3-Signature.html">
                Signature
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-6/4-Services.html">
                Services
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Part-7 Connectivity
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-7/0_Abstract.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-7/1-BusAndConnectors.html">
                Bus and connectors
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-7/2-Wireless.html">
                Wireless
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-7/3-Cloud.html">
                Cloud
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Part-8 Update
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-8/0_Abstract.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-8/1-FOTA.html">
                FOTA
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-8/2-SOTA.html">
                SOTA
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Part-9 Secure development
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/part-9/0_Abstract.html">
                Introduction
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Annexes
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/annexes/0_Abstract.html">
                Annexes
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/annexes/ConfigNotes.html">
                Config notes
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/architecture/en/dev/reference/security/annexes/todoNotes.html">
                Todo notes
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    
</ul>

        
    </li>
    
</ul>

    </div>

    <!-- Page content -->
    <div class="col-md-8 col-md-offset-4 col-lg-9 col-lg-offset-3 page-content-container container">
        <div class="page-content row">
            <div class="col-md-offset-1 col-md-10">
                <div class="content-header">

                    <!-- ToC Dropdown (for XS and SM sizes only) -->
                    <div class="toc-dropdown dropdown visible-xs-block visible-sm-block">
                        <button class="btn btn-default dropdown-toggle" type="button" id="tocDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                            Table of Contents
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu">
                            






<li>
    <a class="" href="reference/AGL_Specifications/agl_spec_v1.0_final.pdf">
        Automotive Grade Linux Requirements Specifications
    </a>
</li>











<li>
    <a class="" href="reference/security/README.html">
        Introduction
    </a>
</li>








<li>
    <a class="" href="reference/security/part-1/0_Abstract.html">
        Introduction
    </a>
</li>











<li>
    <a class="" href="reference/security/part-2/0_Abstract.html">
        Introduction
    </a>
</li>




<li>
    <a class="" href="reference/security/part-2/1-Image.html">
        Image
    </a>
</li>




<li>
    <a class="" href="reference/security/part-2/2-Communication-modes.html">
        Communication modes
    </a>
</li>




<li>
    <a class="" href="reference/security/part-2/3-Consoles.html">
        Consoles
    </a>
</li>











<li>
    <a class="" href="reference/security/part-3/0_Abstract.html">
        Introduction
    </a>
</li>











<li>
    <a class="" href="reference/security/part-4/0_Abstract.html">
        Introduction
    </a>
</li>




<li>
    <a class="" href="reference/security/part-4/1-General.html">
        General
    </a>
</li>




<li>
    <a class="" href="reference/security/part-4/2-Memory.html">
        Memory
    </a>
</li>




<li>
    <a class="" href="reference/security/part-4/3-Consoles.html">
        Consoles
    </a>
</li>




<li>
    <a class="" href="reference/security/part-4/4-Debug.html">
        Debug
    </a>
</li>




<li>
    <a class="" href="reference/security/part-4/5-FileSystems.html">
        File Systems
    </a>
</li>











<li>
    <a class="" href="reference/security/part-5/0_Abstract.html">
        Introduction
    </a>
</li>




<li>
    <a class="this-page" href="reference/security/part-5/1-MAC.html">
        Mandatory Access Control
    </a>
</li>




<li>
    <a class="" href="reference/security/part-5/2-SystemD.html">
        SystemD
    </a>
</li>




<li>
    <a class="" href="reference/security/part-5/3-SystemBus.html">
        SystemBus
    </a>
</li>




<li>
    <a class="" href="reference/security/part-5/4-Services.html">
        System services and daemons
    </a>
</li>




<li>
    <a class="" href="reference/security/part-5/5-AppFw.html">
        Application Framework
    </a>
</li>




<li>
    <a class="" href="reference/security/part-5/6-Utilities.html">
        Utilities
    </a>
</li>




<li>
    <a class="" href="reference/security/part-5/7-Users.html">
        Users
    </a>
</li>











<li>
    <a class="" href="reference/security/part-6/0_Abstract.html">
        Introduction
    </a>
</li>




<li>
    <a class="" href="reference/security/part-6/1-Installation.html">
        Installation
    </a>
</li>




<li>
    <a class="" href="reference/security/part-6/2-PrivilegeManagement.html">
        Privilege management
    </a>
</li>




<li>
    <a class="" href="reference/security/part-6/3-Signature.html">
        Signature
    </a>
</li>




<li>
    <a class="" href="reference/security/part-6/4-Services.html">
        Services
    </a>
</li>











<li>
    <a class="" href="reference/security/part-7/0_Abstract.html">
        Introduction
    </a>
</li>




<li>
    <a class="" href="reference/security/part-7/1-BusAndConnectors.html">
        Bus and connectors
    </a>
</li>




<li>
    <a class="" href="reference/security/part-7/2-Wireless.html">
        Wireless
    </a>
</li>




<li>
    <a class="" href="reference/security/part-7/3-Cloud.html">
        Cloud
    </a>
</li>











<li>
    <a class="" href="reference/security/part-8/0_Abstract.html">
        Introduction
    </a>
</li>




<li>
    <a class="" href="reference/security/part-8/1-FOTA.html">
        FOTA
    </a>
</li>




<li>
    <a class="" href="reference/security/part-8/2-SOTA.html">
        SOTA
    </a>
</li>











<li>
    <a class="" href="reference/security/part-9/0_Abstract.html">
        Introduction
    </a>
</li>











<li>
    <a class="" href="reference/security/annexes/0_Abstract.html">
        Annexes
    </a>
</li>




<li>
    <a class="" href="reference/security/annexes/ConfigNotes.html">
        Config notes
    </a>
</li>




<li>
    <a class="" href="reference/security/annexes/todoNotes.html">
        Todo notes
    </a>
</li>










                        </ul>
                    </div>

                    <!--
                    
                    
                        <a class="edit" href="https://github.com/automotive-grade-linux/docs-agl/edit/master/docs/security-blueprint/part-5/1-MAC.md"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> Edit</a>

                    
                    
                    -->

                    <!-- Language dropdown -->
                    <!--
                    <div class="dropdown">
                        <button class="btn btn-default dropdown-toggle" type="button" id="languageDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                            
                            <span class="caret"></span>
                        </button>

                        <!-- List all languages - ->
                        <ul class="dropdown-menu" aria-labelledby="languageDropdown">
                            
                        </ul>
                    </div>
                    -->

                    <!-- Version dropdown -->
                    <!--
                    <div class="dropdown">
                        <button class="btn btn-default dropdown-toggle" type="button" id="versionDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                            dev
                            
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" aria-labelledby="versionDropdown">

                            <!-- List versions available in this language - ->
                            
                        </ul>
                    </div>
                    -->
                </div>
                

                
                
                

                
                

                <!-- Show warnings for special versions -->
                <!-- dev warning
                
                    <div class="alert docs-alert alert-info" role="alert">
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        Draft version of documentation under development may change!
                        <a href="/docs/en/latest/">
                            Click here for the latest released version.
                        </a>
                    </div>
                
                -->

                <!-- outdated warning
                
                -->


                <div id="page-toc-source">
                    <!-- WARNING: This file is generated by fetch_docs.js using /w/workspace/sandbox-doc-update/webdocs-agl/content/tocs/architecture/fetched_files.yml -->

<h1 id="mandatory-access-control">Mandatory Access Control</h1>

<!-- section-note -->

<p>We decided to put the <strong>MAC</strong> protection on the platform part despite the fact
that it applies to the kernel too, since its use will be mainly at the platform
level (except floor part).</p>

<!-- end-section-note -->

<p><strong>M</strong>andatory <strong>A</strong>ccess <strong>C</strong>ontrol (<strong>MAC</strong>) is a protection provided by the
Linux kernel that requires a <strong>L</strong>inux <strong>S</strong>ecurity <strong>M</strong>odule (<strong>LSM</strong>). AGL
uses an <strong>LSM</strong> called <strong>S</strong>implified <strong>M</strong>andatory <strong>A</strong>ccess <strong>C</strong>ontrol
<strong>K</strong>ernel (<strong>SMACK</strong>). This protection involves the creation of <strong>SMACK</strong>
labels as part of the extended attributes <strong>SMACK</strong> labels to the file extended
attributes. And a policy is also created to define the behaviour of each label.</p>

<p>The kernel access controls is based on these labels and this policy. If there
is no rule, no access will be granted and as a consequence, what is not
explicitly authorized is forbidden.</p>

<p>There are two types of <strong>SMACK</strong> labels:</p>

<ul>
  <li><strong>Execution SMACK</strong> (Attached to the process): Defines how files are
<em>accessed</em> and <em>created</em> by that process.</li>
  <li><strong>File Access SMACK</strong> (Written to the extended attribute of the file): Defines
<em>which</em> process can access the file.</li>
</ul>

<p>By default a process executes with its File Access <strong>SMACK</strong> label unless an
Execution <strong>SMACK</strong> label is defined.</p>

<p>AGL’s <strong>SMACK</strong> scheme is based on the <em>Tizen 3 Q2/2015</em>. It divides the System
into the following domains:</p>

<ul>
  <li>Floor.</li>
  <li>System.</li>
  <li>Applications, Services and User.</li>
</ul>

<p>See <a href="http://iot.bzh/download/public/2017/AMMQ1Tokyo/AGL-security-framework-review.pdf">AGL security framework review</a> and <a href="http://schaufler-ca.com/yahoo_site_admin/assets/docs/SmackWhitePaper.257153003.pdf">Smack White Paper</a>
for more information.</p>

<hr />

<!-- pagebreak -->

<h2 id="floor">Floor</h2>

<p>The <em>floor</em> domain includes the base system services and any associated data and
libraries. This data remains unchanged at runtime. Writing to floor files or
directories is allowed only in development mode or during software installation
or upgrade.</p>

<p>The following table details the <em>floor</em> domain:</p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Name</th>
      <th>Execution <strong>SMACK</strong></th>
      <th>File Access <strong>SMACK</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">-</code></td>
      <td>Floor</td>
      <td><code class="highlighter-rouge">r-x</code> for all</td>
      <td>Only kernel and internal kernel thread.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">^</code></td>
      <td>Hat</td>
      <td><code class="highlighter-rouge">---</code> for all</td>
      <td><code class="highlighter-rouge">rx</code> on all domains.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">*</code></td>
      <td>Star</td>
      <td><code class="highlighter-rouge">rwx</code> for all</td>
      <td>None</td>
    </tr>
  </tbody>
</table>

<!-- section-note -->

<ul>
  <li>
    <p>The Hat label is Only for privileged system services (currently only
systemd-journal). Useful for backup or virus scans. No file with this label
should exist except in the debug log.</p>
  </li>
  <li>
    <p>The Star label is used for device files or <code class="highlighter-rouge">/tmp</code> Access restriction managed
via <strong>DAC</strong>. Individual files remain protected by their <strong>SMACK</strong> label.</p>
  </li>
</ul>

<!-- end-section-note -->
<p><!-- section-config --></p>

<table>
  <thead>
    <tr>
      <th>Domain</th>
      <th><code class="highlighter-rouge">Label</code> name</th>
      <th>Recommendations</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Kernel-MAC-Floor-1</td>
      <td><code class="highlighter-rouge">^</code></td>
      <td>Only for privileged system services.</td>
    </tr>
    <tr>
      <td>Kernel-MAC-Floor-2</td>
      <td><code class="highlighter-rouge">*</code></td>
      <td>Used for device files or <code class="highlighter-rouge">/tmp</code> Access restriction via DAC.</td>
    </tr>
  </tbody>
</table>

<!-- end-section-config -->

<hr />

<!-- pagebreak -->

<h2 id="system">System</h2>

<p>The <em>system</em> domain includes a reduced set of core system services of the OS and
any associated data. This data may change at runtime.</p>

<p>The following table details the <em>system</em> domain:</p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Name</th>
      <th>Execution <strong>SMACK</strong></th>
      <th>File Access <strong>SMACK</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">System</code></td>
      <td>System</td>
      <td>None</td>
      <td>Privileged processes</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">System::Run</code></td>
      <td>Run</td>
      <td><code class="highlighter-rouge">rwxatl</code> for User and System label</td>
      <td>None</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">System::Shared</code></td>
      <td>Shared</td>
      <td><code class="highlighter-rouge">rwxatl</code> for system domain <code class="highlighter-rouge">r-x</code> for User label</td>
      <td>None</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">System::Log</code></td>
      <td>Log</td>
      <td><code class="highlighter-rouge">rwa</code> for System label <code class="highlighter-rouge">xa</code> for user label</td>
      <td>None</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">System::Sub</code></td>
      <td>SubSystem</td>
      <td>Subsystem Config files</td>
      <td>SubSystem only</td>
    </tr>
  </tbody>
</table>

<!-- section-config -->

<table>
  <thead>
    <tr>
      <th>Domain</th>
      <th><code class="highlighter-rouge">Label</code> name</th>
      <th>Recommendations</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Kernel-MAC-System-1</td>
      <td><code class="highlighter-rouge">System</code></td>
      <td>Process should write only to file with transmute attribute.</td>
    </tr>
    <tr>
      <td>Kernel-MAC-System-2</td>
      <td><code class="highlighter-rouge">System::run</code></td>
      <td>Files are created with the directory label from user and system domain (transmute) Lock is implicit with <code class="highlighter-rouge">w</code>.</td>
    </tr>
    <tr>
      <td>Kernel-MAC-System-3</td>
      <td><code class="highlighter-rouge">System::Shared</code></td>
      <td>Files are created with the directory label from system domain (transmute) User domain has locked privilege.</td>
    </tr>
    <tr>
      <td>Kernel-MAC-System-4</td>
      <td><code class="highlighter-rouge">System::Log</code></td>
      <td>Some limitation may impose to add <code class="highlighter-rouge">w</code> to enable append.</td>
    </tr>
    <tr>
      <td>Kernel-MAC-System-5</td>
      <td><code class="highlighter-rouge">System::Sub</code></td>
      <td>Isolation of risky Subsystem.</td>
    </tr>
  </tbody>
</table>

<!-- end-section-config -->

<hr />

<!-- pagebreak -->

<h2 id="applications-services-and-user">Applications, Services and User</h2>

<p>The <em>application</em>, <em>services</em> and <em>user</em> domain includes code that provides
services to the system and user, as well as any associated data. All code
running on this domain is under <em>Cynara</em> control.</p>

<p>The following table details the <em>application</em>, <em>services</em> and <em>user</em> domain:</p>

<table>
  <thead>
    <tr>
      <th>Label</th>
      <th>Name</th>
      <th>Execution <strong>SMACK</strong></th>
      <th>File Access <strong>SMACK</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">User::Pkg::$AppID</code></td>
      <td>AppID</td>
      <td><code class="highlighter-rouge">rwx</code> (for files created by the App). <code class="highlighter-rouge">rx</code> for files installed by <strong>AppFw</strong></td>
      <td>$App runtime executing $App</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">User::Home</code></td>
      <td>Home</td>
      <td><code class="highlighter-rouge">rwx-t</code> from System label <code class="highlighter-rouge">r-x-l</code> from App</td>
      <td>None</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">User::App-Shared</code></td>
      <td>Shared</td>
      <td><code class="highlighter-rouge">rwxat</code> from System and User domains label of $User</td>
      <td>None</td>
    </tr>
  </tbody>
</table>

<!-- section-config -->

<table>
  <thead>
    <tr>
      <th>Domain</th>
      <th><code class="highlighter-rouge">Label</code> name</th>
      <th>Recommendations</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Kernel-MAC-System-1</td>
      <td><code class="highlighter-rouge">User::Pkg::$AppID</code></td>
      <td>Only one Label is allowed per App. A data directory is created by the AppFw in <code class="highlighter-rouge">rwx</code> mode.</td>
    </tr>
    <tr>
      <td>Kernel-MAC-System-2</td>
      <td><code class="highlighter-rouge">User::Home</code></td>
      <td>AppFw needs to create a directory in <code class="highlighter-rouge">/home/$USER/App-Shared</code> at first launch if not present with label app-data access is <code class="highlighter-rouge">User::App-Shared</code> without transmute.</td>
    </tr>
    <tr>
      <td>Kernel-MAC-System-3</td>
      <td><code class="highlighter-rouge">User::App-Shared</code></td>
      <td>Shared space between all App running for a given user.</td>
    </tr>
  </tbody>
</table>

<!-- end-section-config -->

<h2 id="attack-vectors">Attack Vectors</h2>

<p>There are 4 major components to the system:</p>

<ul>
  <li>The LSM kernel module.</li>
  <li>The <code class="highlighter-rouge">smackfs</code> filesystem.</li>
  <li>Basic utilities for policy management and checking.</li>
  <li>The policy/configuration data.</li>
</ul>

<p>As with any mandatory access system, the policy management needs to be carefully separated
from the checking, as the management utilities can become a convenient point of attack.
Dynamic additions to the policy system need to be carefully verified, as the ability to
update the policies is often needed, but introduces a possible threat. Finally,
even if the policy management is well secured, the policy checking and failure response
to that checking is also of vital importance to the smooth operation of the system.</p>

<p>While <strong>MAC</strong> is a certainly a step up in security when compared to DAC, there are still
many ways to compromise a SMACK-enabled Linux system. Some of these ways are as follows:</p>

<ul>
  <li>Disabling SMACK at invocation of the kernel (with command-line: security=none).</li>
  <li>Disabling SMACK in the kernel build and redeploying the kernel.</li>
  <li>Changing a SMACK attribute of a file or directory at install time.</li>
  <li>Tampering with a process with the CAP_MAC_ADMIN privilege.</li>
  <li>Setting/Re-setting the SMACK label of a file.</li>
  <li>Tampering with the default domains (i.e. /etc/smack/accesses.d/default-access-domains).</li>
  <li>Disabling or tampering with the SMACK filesystem (i.e. /smackfs).</li>
  <li>Adding policies with <code class="highlighter-rouge">smackload</code> (adding the utility if not present).</li>
  <li>Changing labels with <code class="highlighter-rouge">chsmack</code> (adding the utility if not present).</li>
</ul>



                </div>
            </div>
        </div>
        <div class="row">
            <div class="blue-divider"></div>
<footer>
    <div class="container-fluid">
        <div class="row">
    <div class="col-sm-9">
        <h1>More Resources</h1>
        <div class="row">
            <div class="col-sm-4">
                <h2>General</h2>
                <ul class="nav">
                    <li>
                        <a target="_blank" href="https://www.automotivelinux.org/">AGL Developer Community</a>
                    </li>
                    <li>
                        <a href="https://www.automotivelinux.org/software/download/">Download Distribution</a>
                    </li>
                    <li>
                        <a href="https://gerrit.automotivelinux.org/gerrit/#/admin/projects/">Source Code on Git</a>
                    </li>
                    <li>
                        <a target="_blank" href="/contact">Mailing List</a>
                    </li>
                </ul>
            </div>
            <div class="col-sm-4">
                <h2>Development</h2>
                <ul class="nav">
                    <li><a target="_blank" href="https://wiki.automotivelinux.org/agl-distro/source-code">Source Code</a></li>
                    <li><a target="_blank" href="https://jira.automotivelinux.org/browse/SPEC/?selectedTab=com.atlassian.jira.jira-projects-plugin:summary-panel">Issue Tracker</a></li>
                    <li><a target="_blank" href="https://wiki.automotivelinux.org/">Wiki</a></li>
                    <li><a href="https://www.automotivelinux.org/contact-us">Contact</a></li>
                </ul>
            </div>
            <div class="col-sm-4">
                <h2>Automotive Grade Linux @ Linux Foundation</h2>
                <ul class="nav">
                    <li>
                        <a target="_blank" href="https://www.automotivelinux.org/">About AGL</a>
                    </li>
                    <li>
                        <a target="_blank" href="http://www.linuxfoundation.org/">About Linux Foundation</a>
                    </li>
                    <li>
                        <a target="_blank" href="https://wiki.automotivelinux.org/start/getting-started">Join AGL community</a>
                    </li>
                    <li>
                        <a target="_blank" href="https://www.automotivelinux.org/about/members">Members</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="col-sm-3">
        <h1>Contribute</h1>
        <p style="padding-top:20px"><strong>Help AGL move forward!</strong></p>
        <p>Report bugs, improve the docs, or contribute to the code.</p>
        <a href="/contribute" class="btn btn-lg btn-primary">
            Learn More
        </a>
        <p style="padding-top:20px"> <a href="https://twitter.com/autogradelinux" class="twitter-follow-button" data-show-count="false">Follow @autogradelinux</a></p>
    </div>
</div>
<div class="row">
	<div class="col-sm-9">
		<p class="copyright_text">
			Copyright &copy; 2015-2018 Automotive Grade Linux Documentation, Licensed under the <a target="_blank" href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
			<br/>
			Automotive Grade Linux and logos are <a target="_blank" href="http://www.linuxfoundation.org">trademarks</a> of The Linux Foundation.
			<br/>
			Initial site design from <a href="https://cordova.apache.org/">Cordova website.</a> - warm thanks !
		</p>
	</div>
    <div class="col-sm-3">
		<small class="stats">Page rendered at:  2018-07-30 00:01:36 +0000</small>
		
		<br/><small class="stats"><a href="https://raw.githubusercontent.com/automotive-grade-linux/docs-agl/master/docs/security-blueprint/part-5/1-MAC.md">Link to source document</small>
		
	</div>
</div>

    </div>
</footer>

        </div>
    </div>
</div>

<script defer type="text/javascript" src="/static/js/lib/toc.min.js"></script>
<script defer type="text/javascript" src="/static/js/docs.js"></script>

    <script defer type="text/javascript" src="/static/js/twitter.js"></script>
    



<script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
<script type="text/javascript">
    docsearch({
        apiKey: 'edd30bcff9f6df4b095c41cba3e5a418',
        indexName: 'automotivelinux',
        inputSelector: '#header-search-field',
    });
</script>

            
    

</body>
</html>
