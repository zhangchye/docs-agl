<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
    <meta name="description" content=" ">

    <title>
	    AGL Developer Site - 
        
            
                Build for Renesas Porter board  -
            
        
    </title>

    <link rel="SHORTCUT ICON" href="/favicon.ico"/>

    

    
    

    <link rel="canonical" href="http://docs.automotivelinux.org/docs/getting_started/en/dev/reference/machines/porter.html">

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="/static/styles/main.css">
    <link rel="stylesheet" type="text/css" href="/static/styles/syntax.css">
    <!-- Algolia Search CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />

    <!-- Fonts -->
    <!-- For attribution information, see www/attributions.html -->
    <link href='https://fonts.googleapis.com/css?family=Raleway:700,400,300,700italic,400italic,300italic' rel='stylesheet' type='text/css'>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- <script defer type="text/javascript">
        var disqus_developer = ; // this would set it to developer mode
    </script>-->

    <!-- JS -->
    <script defer type="text/javascript" src="/static/js/lib/jquery-2.1.1.min.js"></script>
    <script defer type="text/javascript" src="/static/js/lib/bootstrap.min.js"></script>
<!--    <script defer type="text/javascript" src="/static/js/lib/ZeroClipboard.js"></script>-->

    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', '{}', 'auto');
    ga('send', 'pageview');
</script>

</head>

<body>
    <header>
    <a class="scroll-point pt-top" name="top"></a>
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" href="/"><img id="logo_top" src="/static/img/branding/agl_title_793x211.png"/></a>
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <div class="nav_bar_left">
                    <ul class="nav navbar-nav">
                        <li >
                            <a href="/docs/getting_started/en/dev/">Getting Started</a>
                        </li>
                                                
                        <li >
                            <a href="/docs/architecture/en/dev/">Architecture Guides</a>
                        </li>

                        <li >
                            <a href="/docs/hardware/en/dev/">Hardware Support</a>
                        </li>

                        <li >
                            <a href="/docs/devguides/en/dev/">Developer Guides</a>
                        </li>
                        
                        <li >
                            <a href="/docs/apis_services/en/dev/">APIs & Services</a>
                        </li>
					</ul>
				</div>
                <div class="nav_bar_right">
                    <ul class="nav navbar-nav">
                        <li >
                            <a href="/techpost" id="blog_button">TechPost<span class="badge" id="new_blog_count"></span></a>
                        </li>
                        <li >
                            <a href="/contribute">Contribute</a>
                        </li>
                        <li>
                            <form class="navbar-form navbar-right" id="header-search-form" role="search">
                                <div class="input-group">
                                    
                                    <input id="header-search-field" type="text" placeholder="Search 'dev' docs..." class="form-control hidden-xs" autocomplete="off">
                                </div>
                            </form>
                        </li>
                    </ul>
                </div>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    <div id="_fixed_navbar_spacer" style="padding-top:50px"></div>
</header>














<div class="docs container">

    <!-- Table of Contents -->
    <div class="hidden-xs hidden-sm col-md-4 col-lg-3 site-toc-container">
        <ul class="site-toc">
    

    <li>
        
            <span class="toc-section-heading">
                Getting Started
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/getting_started/en/dev/reference/source-code.html">
                Download AGL Source Code
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/getting_started/en/dev/reference/customize_bitbake_conf.html">
                Customize the AGL build
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/getting_started/en/dev/reference/machines/intel.html">
                Build for Intel
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/getting_started/en/dev/reference/machines/qemu.html">
                Build for Qemu
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="this-page" href="/docs/getting_started/en/dev/reference/machines/porter.html">
                Build for Renesas Porter board
            </a>
            
                <span class="entry-highlight"></span>
            
        

        
        <div id="page-toc" class="page-toc"></div>

        
    </li>
    

    <li>
        
            <a class="" href="/docs/getting_started/en/dev/reference/machines/R-Car-Starter-Kit-gen3.html">
                Build for R Car Starter Kit gen3 board
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/getting_started/en/dev/reference/machines/raspberrypi.html">
                Build for Raspberry PI 2/3
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                HomeScreen
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/getting_started/en/dev/reference/homescreen/index.html">
                Overview
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                Troubleshooting
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/getting_started/en/dev/reference/troubleshooting.html">
                Generic issues
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/getting_started/en/dev/reference/footers/intel-footer.html">
                Intel Boards
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/getting_started/en/dev/reference/footers/porter-footer.html">
                Porter board
            </a>
            
        

        
        

        
    </li>
    

    <li>
        
            <a class="" href="/docs/getting_started/en/dev/reference/footers/raspberrypi-footer.html">
                Raspberry PI
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    

    <li>
        
            <span class="toc-section-heading">
                SDK
            </span>
        

        
        

        
        <ul class="site-toc">
    

    <li>
        
            <a class="" href="/docs/getting_started/en/dev/reference/setup-sdk-environment.html">
                SDK Quick Setup
            </a>
            
        

        
        

        
    </li>
    
</ul>

        
    </li>
    
</ul>

    </div>

    <!-- Page content -->
    <div class="col-md-8 col-md-offset-4 col-lg-9 col-lg-offset-3 page-content-container container">
        <div class="page-content row">
            <div class="col-md-offset-1 col-md-10">
                <div class="content-header">

                    <!-- ToC Dropdown (for XS and SM sizes only) -->
                    <div class="toc-dropdown dropdown visible-xs-block visible-sm-block">
                        <button class="btn btn-default dropdown-toggle" type="button" id="tocDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                            Table of Contents
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu">
                            






<li>
    <a class="" href="reference/source-code.html">
        Download AGL Source Code
    </a>
</li>




<li>
    <a class="" href="reference/customize_bitbake_conf.html">
        Customize the AGL build
    </a>
</li>




<li>
    <a class="" href="reference/machines/intel.html">
        Build for Intel
    </a>
</li>




<li>
    <a class="" href="reference/machines/qemu.html">
        Build for Qemu
    </a>
</li>




<li>
    <a class="this-page" href="reference/machines/porter.html">
        Build for Renesas Porter board
    </a>
</li>




<li>
    <a class="" href="reference/machines/R-Car-Starter-Kit-gen3.html">
        Build for R Car Starter Kit gen3 board
    </a>
</li>




<li>
    <a class="" href="reference/machines/raspberrypi.html">
        Build for Raspberry PI 2/3
    </a>
</li>











<li>
    <a class="" href="reference/homescreen/index.html">
        Overview
    </a>
</li>











<li>
    <a class="" href="reference/troubleshooting.html">
        Generic issues
    </a>
</li>




<li>
    <a class="" href="reference/footers/intel-footer.html">
        Intel Boards
    </a>
</li>




<li>
    <a class="" href="reference/footers/porter-footer.html">
        Porter board
    </a>
</li>




<li>
    <a class="" href="reference/footers/raspberrypi-footer.html">
        Raspberry PI
    </a>
</li>











<li>
    <a class="" href="reference/setup-sdk-environment.html">
        SDK Quick Setup
    </a>
</li>







                        </ul>
                    </div>

                    <!--
                    
                    
                        <a class="edit" href="https://github.com/automotive-grade-linux/docs-agl/edit/master/docs/getting-started/machines/porter.md"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> Edit</a>

                    
                    
                    -->

                    <!-- Language dropdown -->
                    <!--
                    <div class="dropdown">
                        <button class="btn btn-default dropdown-toggle" type="button" id="languageDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                            
                            <span class="caret"></span>
                        </button>

                        <!-- List all languages - ->
                        <ul class="dropdown-menu" aria-labelledby="languageDropdown">
                            
                        </ul>
                    </div>
                    -->

                    <!-- Version dropdown -->
                    <!--
                    <div class="dropdown">
                        <button class="btn btn-default dropdown-toggle" type="button" id="versionDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                            dev
                            
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" aria-labelledby="versionDropdown">

                            <!-- List versions available in this language - ->
                            
                        </ul>
                    </div>
                    -->
                </div>
                

                
                
                

                
                

                <!-- Show warnings for special versions -->
                <!-- dev warning
                
                    <div class="alert docs-alert alert-info" role="alert">
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        Draft version of documentation under development may change!
                        <a href="/docs/en/latest/">
                            Click here for the latest released version.
                        </a>
                    </div>
                
                -->

                <!-- outdated warning
                
                -->


                <div id="page-toc-source">
                    <!-- WARNING: This file is generated by fetch_docs.js using /w/workspace/sandbox-doc-update/webdocs-agl/content/tocs/getting_started/fetched_files.yml -->

<h1 id="renesas-porter-hardware-setup">Renesas Porter Hardware setup</h1>

<p>Here is a non exhaustive list of hardware parts that could be used to setup the Porter board development environment:</p>

<ul>
  <li>Porter board with its power supply</li>
  <li>mini USB-A cable for serial console</li>
  <li>USB 2.0 Hub</li>
  <li>USB keyboard</li>
  <li>USB mouse</li>
  <li>Ethernet cable</li>
  <li>HDMI type A (full size HDMI) cable and associated display</li>
  <li>micro-SD Card (at least 4GB)</li>
  <li>USB touch screen device like the GeChic 1502i</li>
</ul>

<p>For more information and latest news, please check <a href="http://elinux.org/R-Car/Boards/Porter">Here</a>:</p>

<p>The following documents may also be helpful:</p>

<ul>
  <li>Porter Hardware Manual <a href="http://elinux.org/images/8/83/Porter_HardwareManual_02242015.pdf">Link</a></li>
  <li>Porter (Rev B) Setup Manual <a href="http://elinux.org/images/1/11/PORTER_B_SetupManual_rev0.01.pdf">Link</a></li>
</ul>

<h2 id="building-the-agl-demo-platform-for-renesas-porter">Building the AGL Demo Platform for Renesas Porter</h2>

<p>Before set up Build Environment you need to setup the proprietary drivers.</p>

<ul>
  <li>Download Renesas graphics drivers with a “click through” license from Renesas website <a href="https://www.renesas.com/en-eu/solutions/automotive/rcar-demoboard.html">Link</a></li>
</ul>

<p>under the Target hardware: R-Car H2, M2 and E2 section.</p>

<p><strong>Note</strong>:</p>

<ul>
  <li>that you have to register with a free account on MyRenesas and accept the license condition before downloading them.
 The operation is fast and simple but nevertheless mandatory to access evaluation of non open-source drivers for free.
 Once you registered, you can download two zip files.</li>
  <li>The files must be store into directory ~/Downloads (or $XDG_DOWNLOAD_DIR).</li>
</ul>

<p>Here after is an example of their names:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>chmod a+r <span class="nv">$XDG_DOWNLOAD_DIR</span>/<span class="k">*</span>.zip
ls -l <span class="nv">$XDG_DOWNLOAD_DIR</span>
total 8220
-rw-r--r-- 1 1000 1000 6047383 Jul 11 11:03 R-Car_Series_Evaluation_Software_Package_for_Linux-20151228.zip
-rw-r--r-- 1 1000 1000 2394750 Jul 11 11:03 R-Car_Series_Evaluation_Software_Package_of_Linux_Drivers-20151228.zip
</code></pre>
</div>

<h2 id="set-up-build-environment">Set up Build Environment</h2>

<ul>
  <li>To build AGL demo platform for Renesas Porter board use machine <strong>porter</strong> and feature <strong>agl-demo</strong>:</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nb">cd</span> <span class="nv">$AGL_TOP</span>
<span class="nb">source </span>meta-agl/scripts/aglsetup.sh -m porter -b build agl-devel agl-demo agl-netboot agl-appfw-smack
</code></pre>
</div>

<p><strong>Note</strong>:</p>

<ul>
  <li><strong>IMPORTANT</strong> read the log to be sure to have any error during your setup.</li>
</ul>

<p>In case the graphical drivers were not found, you could notice an error message as follow:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="o">[</span>snip]
--- fragment /ssd/agl2016-for-kickstart-update/meta-agl/templates/machine/porter/50_setup.sh
/ssd/agl2016-for-kickstart-update /ssd/agl2016-for-kickstart-update/build
The graphics and multimedia acceleration packages <span class="k">for </span>the R-Car M2 Porter board can be download from :
  &lt;http://www.renesas.com/secret/r_car_download/rcar_demoboard.jsp&gt;

These 2 files from there should be store <span class="k">in </span>your<span class="s1">'/home/users/Downloads'</span> directory.
  R-Car_Series_Evaluation_Software_Package_for_Linux-20151228.zip
  R-Car_Series_Evaluation_Software_Package_of_Linux_Drivers-20151228.zip
Copying gfx drivers and multimedia packages <span class="k">for</span> <span class="s1">'porter'</span> failed.
ERROR: Script /ssd/agl2016-for-kickstart-update/build/conf/setup.sh failed
OK
Generating setup file: /ssd/agl2016-for-kickstart-update/build/agl-init-build-env ... OK
------------ aglsetup.sh: Done
<span class="o">[</span>snip]
</code></pre>
</div>

<ul>
  <li>If you encounters this issue, or any other unwanted behavior, you can fix the error mentioned and then clean up by removing the “$AGL_TOP/build” directory then launch the procedure again.</li>
  <li>After this command, the working directory is changed to $AGL_TOP/build.</li>
  <li>Users may want to check that the board is correctly selected in the environment:</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>grep -w -e <span class="s2">"^MACHINE ="</span> <span class="nv">$AGL_TOP</span>/build/conf/local.conf
    MACHINE <span class="o">=</span> <span class="s2">"porter"</span>
</code></pre>
</div>

<p>Configure for Release or Development:<br />
Development images require extra tools for developer convenience, in particular:</p>

<ul>
  <li>a debugger (gdb)</li>
  <li>some tweaks, including a disabled root password</li>
  <li>a SFTP server</li>
  <li>the TCF Agent for easier application deployment and remote debugging</li>
  <li>…</li>
</ul>

<p>We explicitely activate these Debug facilities by specifying the “agl-devel agl-netboot” feature.</p>

<h3 id="build-your-image">Build your image</h3>

<p>The process to build an image is simple:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>bitbake agl-demo-platform
</code></pre>
</div>

<p>Once done, what may take up to few hours, you should get the end result in the directory:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nv">$AGL_TOP</span>/build/tmp/deploy/images/porter.
</code></pre>
</div>

<p><strong>Note</strong>:</p>

<ul>
  <li>In case of failure of the build it is safe to first check that the Linux distribution chosen for your host has been validated for version 2.0 of Yocto.</li>
</ul>

<h2 id="booting-agl-demo-platform-on-renesas-porter-using-a-micro-sd-card">Booting AGL Demo Platform on Renesas Porter using a micro-SD card</h2>

<p><strong>Note</strong>:</p>

<p>Porter boards have 2 SD slots:</p>

<ul>
  <li>one for SD cards</li>
  <li>another one for micro-SD cards.</li>
</ul>

<p>At the time of writing, we didn’t succeed to boot a board using the SD slot with the current kernel (3.10):</p>

<ul>
  <li>Only the micro-SD slot was usable.</li>
</ul>

<p>To boot the board using a micro-SD card, there are two operations that should be done prior to first initial boot:</p>

<ul>
  <li>Create a SD-card with one ext3 partition,</li>
  <li>Set up the board to boot on the SD-card.</li>
</ul>

<p>Then for each build, the SD-card is merely rewritten and used to boot the configured board.</p>

<h2 id="deployment">Deployment</h2>

<h3 id="format-the-sd-card-on-the-host">Format the SD-card on the host</h3>

<ul>
  <li>
    <table>
      <tbody>
        <tr>
          <td>Plug microSD card and get its associated device by either running *dmesg</td>
          <td>tail -15* or <em>lsblk</em>, for example:</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>dmesg | tail -15

  <span class="o">[</span> 1971.462160] sd 6:0:0:0: <span class="o">[</span>sdc] Mode Sense: 03 00 00 00
  <span class="o">[</span> 1971.462277] sd 6:0:0:0: <span class="o">[</span>sdc] No Caching mode page found
  <span class="o">[</span> 1971.462278] sd 6:0:0:0: <span class="o">[</span>sdc] Assuming drive cache: write through
  <span class="o">[</span> 1971.463870]  sdc: sdc1 sdc2
</code></pre>
</div>

<p>Here, the SD-card is attached to the device sdc.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>lsblk

  NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
  sda      8:0    0 167,7G  0 disk
  ├─sda1   8:1    0   512M  0 part /boot/efi
  ├─sda2   8:2    0 159,3G  0 part /
  └─sda3   8:3    0   7,9G  0 part <span class="o">[</span>SWAP]
  sdb      8:16   0 931,5G  0 disk
  └─sdb1   8:17   0 931,5G  0 part /media/storage
  sdc      8:32   1  14,9G  0 disk
  ├─sdc1   8:33   1    40M  0 part
  └─sdc2   8:34   1   788M  0 part
</code></pre>
</div>

<p><strong>Note</strong>:</p>

<ul>
  <li><strong>WARNING</strong> This is a critical operation, each computer is different and device can change during time, so do this operation each time you incert the microSD card.</li>
  <li>In the <strong>example</strong> above, we see the first SATA drive as ‘sda’.</li>
  <li>In the <strong>example</strong> above, ‘sdc’ corresponds to the microSD card.*</li>
</ul>

<h3 id="format-the-sd-card">Format the SD-card</h3>

<p>Create EXT3 partition on the SD-card using fdisk and set the MBR.</p>

<ul>
  <li>For <strong>example</strong>, if the microSD card is <em>/dev/sdc</em>:</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo fdisk /dev/sdc

  Welcome to fdisk <span class="o">(</span>util-linux 2.27.1<span class="o">)</span>.
  Changes will remain <span class="k">in </span>memory only, <span class="k">until </span>you decide to write them.
  Be careful before using the write command.


  Command <span class="o">(</span>m <span class="k">for </span><span class="nb">help</span><span class="o">)</span>: o
  Created a new DOS disklabel with disk identifier 0x96e5850d.

  Command <span class="o">(</span>m <span class="k">for </span><span class="nb">help</span><span class="o">)</span>: n
  Partition <span class="nb">type
     </span>p   primary <span class="o">(</span>0 primary, 0 extended, 4 free<span class="o">)</span>
     e   extended <span class="o">(</span>container <span class="k">for </span>logical partitions<span class="o">)</span>
  Select <span class="o">(</span>default p<span class="o">)</span>:

  Using default response p.
  Partition number <span class="o">(</span>1-4, default 1<span class="o">)</span>:
  First sector <span class="o">(</span>2048-31291391, default 2048<span class="o">)</span>:
  Last sector, +sectors or +size<span class="o">{</span>K,M,G,T,P<span class="o">}</span> <span class="o">(</span>2048-31291391, default 31291391<span class="o">)</span>:

  Created a new partition 1 of <span class="nb">type</span> <span class="s1">'Linux'</span> and of size 14,9 GiB.

  Command <span class="o">(</span>m <span class="k">for </span><span class="nb">help</span><span class="o">)</span>: w
  The partition table has been altered.
  Calling ioctl<span class="o">()</span> to re-read partition table.
  Syncing disks.
</code></pre>
</div>

<p>Initialize the ext3 partition using “mke2fs”:</p>

<ul>
  <li>for <strong>example</strong> if the microSD card is associated with <em>sdc</em>:</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo mke2fs -t ext3 /dev/sdc1

  mke2fs 1.42.13 <span class="o">(</span>17-May-2015<span class="o">)</span>
  Creating filesystem with 3911168 4k blocks and 979200 inodes
  Filesystem UUID: 690804b9-6c7d-4bbb-b1c1-e9357efabc52
  Superblock backups stored on blocks:
      32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208

  Allocating group tables: <span class="k">done
  </span>Writing inode tables: <span class="k">done
  </span>Creating journal <span class="o">(</span>32768 blocks<span class="o">)</span>: <span class="k">done
  </span>Writing superblocks and filesystem accounting information: <span class="k">done</span>
</code></pre>
</div>

<h3 id="copying-the-built-image-to-the-sd-card">Copying the built image to the SD-card</h3>

<p>Insert the SD-card into your build host:</p>

<ul>
  <li>Your desktop system may probably offer a choice to mount the SD-card automatically in some directory.</li>
  <li>In the next sample code, we’ll suppose that the SD-card mount directory is stored in the variable $SDCARD.</li>
  <li>For example <strong>example</strong> the microSD card is associated with device <em>sdc</em>:</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nb">export </span><span class="nv">SDCARD</span><span class="o">=</span>/tmp/agl
mkdir -p <span class="nv">$SDCARD</span>
sudo mount /dev/sdc1 <span class="nv">$SDCARD</span>
</code></pre>
</div>

<p>Go to your build directory:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nb">cd</span> <span class="nv">$AGL_TOP</span>/build/tmp/deploy/images/porter
</code></pre>
</div>

<p>Make sure the filesystem is empty:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo rm -rf <span class="k">${</span><span class="nv">SDCARD</span><span class="k">:-</span><span class="nv">bad_dir</span><span class="k">}</span>/<span class="k">*</span>
</code></pre>
</div>

<p><strong>* IMPORTANT ***
Verify that **tar</strong> version is 1.28 or newer:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>tar --version
tar <span class="o">(</span>GNU tar<span class="o">)</span> 1.28
<span class="o">[</span>snip]
</code></pre>
</div>

<p>If your distribution is up to date on this dependency, you can use the host tool directly. Let’s define a variable for the following steps:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nv">TAR</span><span class="o">=</span><span class="k">$(</span>which tar<span class="k">)</span>
</code></pre>
</div>

<p>Otherwise, a native up-to-date version of tar is also generated while building AGL distribution:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nv">TAR</span><span class="o">=</span><span class="nv">$AGL_TOP</span>/build/tmp/sysroots/x86_64-linux/usr/bin/tar-native/tar
<span class="nv">$TAR</span> --version
tar <span class="o">(</span>GNU tar<span class="o">)</span> 1.28
<span class="o">[</span>snip]
</code></pre>
</div>

<p>Copy Automotive Grade Linux (AGL) files onto the mircoSD card by extracting the root file system archive:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo <span class="nv">$TAR</span> --extract --xz --numeric-owner --preserve-permissions --preserve-order --totals <span class="se">\</span>
           --xattrs-include<span class="o">=</span><span class="s1">'*'</span> --directory<span class="o">=</span><span class="nv">$SDCARD</span> --file<span class="o">=</span>agl-demo-platform-porter.tar.xz
</code></pre>
</div>

<p>Copy Kernel Image and Device Tree Blob file into the <strong>boot</strong> directory:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo cp uImage+dtb /tmp/agl/boot/
</code></pre>
</div>

<p>Ensure the changes have been written to the disk:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sync
</code></pre>
</div>

<p>Unmount the micrSD card:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo umount <span class="nv">$SDCARD</span>
</code></pre>
</div>

<h3 id="booting-the-board">Booting the board</h3>

<p>Turn the board off using the power switch.
Insert the microSD-card into the appropriate slot.
Verify that you have plugged in, at least, the following:</p>

<ul>
  <li>External monitor on HDMI port</li>
  <li>Input device (keyboard, mouse, touchscreen…) on USB port.</li>
</ul>

<p>Turn the board on using the power switch.
After a few seconds, you’ll see the AGL splash screen on the display and you’ll be able to log in on the console terminal (login is ‘root’, no password):</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Automotive Grade Linux 2.0.0 porter ttySC6

porter login:
</code></pre>
</div>

<h3 id="to-access-the-shell-serial">To access the shell (serial)</h3>

<p>Install a serial client on your computer.
This can be “screen”, “picocom”, “minicom”.
The lighter of the 3 is “picocom” (it has less dependencies).
Plug a USB cable from your computer to the serial CP2102 USB port of the porter board (near the power switch and fan connector).
With “dmesg” you can check the device created for the serial link.
To get it, you must switch the board on.
For example:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>dmesg | tail
  <span class="o">[</span>609575.767056] usb 2-1.6.4: new full-speed USB device number 21 using ehci-pci
  <span class="o">[</span>609575.854083] usb 2-1.6.4: New USB device found, <span class="nv">idVendor</span><span class="o">=</span>10c4, <span class="nv">idProduct</span><span class="o">=</span>ea60
  <span class="o">[</span>609575.854089] usb 2-1.6.4: New USB device strings: <span class="nv">Mfr</span><span class="o">=</span>1, <span class="nv">Product</span><span class="o">=</span>2, <span class="nv">SerialNumber</span><span class="o">=</span>3
  <span class="o">[</span>609575.854100] usb 2-1.6.4: Product: CP2102 USB to UART Bridge Controller
  <span class="o">[</span>609575.854102] usb 2-1.6.4: Manufacturer: Silicon Labs
  <span class="o">[</span>609575.854104] usb 2-1.6.4: SerialNumber: 0001
  <span class="o">[</span>609575.990209] usbcore: registered new interface driver usbserial
  <span class="o">[</span>609575.990221] usbcore: registered new interface driver usbserial_generic
  <span class="o">[</span>609575.990229] usbserial: USB Serial support registered <span class="k">for </span>generic
  <span class="o">[</span>609575.995184] usbcore: registered new interface driver cp210x
  <span class="o">[</span>609575.995198] usbserial: USB Serial support registered <span class="k">for </span>cp210x
  <span class="o">[</span>609575.995239] cp210x 2-1.6.4:1.0: cp210x converter detected
  <span class="o">[</span>609576.068184] usb 2-1.6.4: reset full-speed USB device number 21 using ehci-pci
  <span class="o">[</span>609576.154125] usb 2-1.6.4: cp210x converter now attached to ttyUSB0
</code></pre>
</div>

<p>The link is attached to the device /dev/ttyUSB0.
It is time to launch your serial client.
Example:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>picocom -b 38400 /dev/ttyUSB0
</code></pre>
</div>

<p>or</p>

<div class="highlighter-rouge"><pre class="highlight"><code>minicom -b 38400 -D /dev/ttyUSB0
</code></pre>
</div>

<p>or</p>

<div class="highlighter-rouge"><pre class="highlight"><code>screen /dev/ttyUSB0 38400
</code></pre>
</div>

<p>Power on the Porter board to see a shell on the console</p>

<div class="highlighter-rouge"><pre class="highlight"><code>KOELSCH SPI_LOADER<span class="o">(</span>DDR3L_1333<span class="o">)</span> V0.16a 2014.10.03
 DEVICE S25FL512


U-Boot 2013.01.01-gb653737-dirty <span class="o">(</span>Mar 26 2015 - 14:37:46<span class="o">)</span>

CPU: Renesas Electronics R8A7791 rev 2.0
Board: Porter Board

DRAM:  1 GiB
MMC:   sh-sdhi: 0, sh-sdhi: 1
SF: Detected S25FL512S with page size 256 KiB, total 64 MiB
In:    serial
Out:   serial
Err:   serial
Net:   sh_eth
Hit any key to stop autoboot:  0
<span class="o">=</span>&gt;
</code></pre>
</div>

<h3 id="u-boot-configurations">U-Boot configurations</h3>

<p>Follow the steps below to configure boot from microSD card and to set screen resolution:</p>

<ul>
  <li>Power up the board and, using your preferred terminal emulator.</li>
  <li>Type a character to abort the boot and enter the U-boot menu.</li>
  <li>Type <strong>print</strong> to check the environment:</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>print
</code></pre>
</div>

<ul>
  <li>Verify that the ethaddr environment variable is set to the same MAC address value shown on the label on top of the RJ45 Ethernet connector.</li>
  <li>If not please set it using the following command:</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>setenv ethaddr &lt;MAC address&gt;
</code></pre>
</div>

<p>For example:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>setenv ethaddr 2e:09:0a:00:75:b5
</code></pre>
</div>

<ul>
  <li>Set the follow environment variables:</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>setenv bootargs_console <span class="s1">'console=ttySC6,38400 ignore_loglevel'</span>
setenv bootargs_video <span class="s1">'vmalloc=384M video=HDMI-A-1:1920x1080-32@60'</span>
setenv bootargs_root <span class="s1">'root=/dev/mmcblk0p1 rootdelay=3 ro rootfstype=ext4 rootwait'</span>
setenv bootmmc <span class="s1">'1:1'</span>
setenv bootcmd_sd <span class="s1">'ext4load mmc ${bootmmc} 0x40007fc0 boot/uImage+dtb'</span>
setenv bootcmd <span class="s1">'setenv bootargs ${bootargs_console} ${bootargs_video} ${bootargs_root}; run bootcmd_sd; bootm 0x40007fc0'</span>
</code></pre>
</div>

<p><strong>WARNINGS:</strong></p>

<ul>
  <li>
    <p>If no display shows up when booting, e.g. for a non-full HD screen, replace  <strong>1920x1080</strong> value in the <strong>bootargs_video</strong> variable with lower screen resolution such as <strong>1024x768</strong>.   Unfortunately for the moment there are no universally supported setting.</p>
  </li>
  <li>
    <p>Depending on your board (Porter rev B or rev C, Koelsch etc.), the SD card slots may differ.</p>
  </li>
</ul>

<p>Try setting <strong>bootmmc</strong> to <strong>0:1</strong> or <strong>2:1</strong> depending on the slot and card format.</p>

<p>For Renesas Porter Rev 1.0 use screen resolution <strong>1024x768</strong> and set <strong>bootmmc</strong> to <strong>2:1</strong>.</p>

<ul>
  <li>Save the environment variables:</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>saveenv
  Saving Environment to SPI Flash...
  SF: Detected S25FL512S with page size 256 KiB, total 64 MiB
  Erasing SPI flash...Writing to SPI flash...done
</code></pre>
</div>

<ul>
  <li>Reboot:</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>reset
</code></pre>
</div>

<h3 id="writing-a-hello-world-application">Writing a “hello world” application</h3>

<p>Yocto project provides a good reference on its complete solution for developers:</p>

<ul>
  <li>ADT: The Application Development Toolkit is the complete solution;</li>
  <li>the cross-toolchain is a simple build environment.</li>
</ul>

<p>Reading <a href="http://www.yoctoproject.org/docs/2.0/adt-manual/adt-manual.html">adt-manual</a> is a good starting point.
A Docker image with prebuilt AGL SDK is also made available by <a href="http://iot.bzh/">IoT.bzh</a>.
Check the following document for more information <a href="http://iot.bzh/download/public/2016/sdk/AGL-Application-SDK-Kickstart-on-Renesas-Porter-board.pdf">Link</a>:</p>

<p>Here, for a quick demo we will build the cross-toolchain and write a sample application.
First, let’s create the build toolchain:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nb">cd</span> <span class="nv">$AGL_TOP</span>
<span class="nb">source </span>poky/oe-init-build-env
bitbake meta-ide-support
</code></pre>
</div>

<p>The small following “hello world” example:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>cat hello.c
<span class="c">#include &lt;stdio.h&gt;</span>
int main<span class="o">()</span> <span class="o">{</span> <span class="nb">printf</span><span class="o">(</span>“Hello world<span class="se">\n</span>”<span class="o">)</span>; <span class="k">return </span>0; <span class="o">}</span>
</code></pre>
</div>

<p>… can now be compiled and executed this way:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>. <span class="nv">$AGL_TOP</span>/build/tmp/environment-setup-<span class="k">*</span>
<span class="nv">$CC</span> -o hello hello.c
scp hello root@porterboard:/
ssh root@porterboard /hello
</code></pre>
</div>

<p>where ‘porterboard’ is replaced by the IP address or the hostname of your Porter board.</p>

<h3 id="running-ces-2016-demos">Running CES 2016 Demos</h3>

<p>The CES demos are located in /opt/AGL/CES2016 (on the microSD-Card).
To run the demo, execute the following commands on the target (from a weston terminal or from the serial console)</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nb">cd</span> /opt/AGL/CES2016
<span class="nb">export </span><span class="nv">LD_PRELOAD</span><span class="o">=</span>/usr/lib/libEGL.so
</code></pre>
</div>

<p>For the main demo, run:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>/usr/bin/qt5/qmlscene -–fullscreen -I imports Main.qml
</code></pre>
</div>

<p>To start the demo using IVI Shell, run the appropriate scripts located in /opt/AGL/CES2016:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>./switch_to_ivi-shell.sh
./start_CES2016_ivi-shell.sh
</code></pre>
</div>

<p>This will restart Weston with IVI Shell enabled and launch the demo.
With the above commands, the demo application has still some decorations.
They can be dropped by adding ‘–fullscreen’ in the script. Use the following command once to modify the script.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sed -i <span class="s1">'s/Main.qml/--fullscreen Main.qml/'</span> start_CES2016_ivi-shell.sh
</code></pre>
</div>

<p>Then restart the demo:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>killall qmlscene
./start_CES2016_ivi-shell.sh
</code></pre>
</div>

<h4 id="important">IMPORTANT</h4>

<p>Please note that the current image uses Evaluation drivers:</p>

<ul>
  <li>as a consequence, the graphics and multimedia acceleration provided by these drivers will stop after 3 hours. When this happens, simply reboot the board and restart the demo.</li>
</ul>

<p>For more information, you can check the embedded README:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>cat /opt/AGL/CES2016/README.md
Open <span class="nb">source </span>QML UI

To run on target:
<span class="gp">$ </span><span class="nb">cd</span> /opt/AGL/CES2016
<span class="gp">$ </span>/usr/bin/qt5/qmlscene -I imports Main.qml

For development it can be nice to use Scaled.qml instead so it fits your screen.



© 2015 Jaguar Land Rover. All Rights Reserved.
Licensed under Creative Commons Attribution 4.0 International
https://creativecommons.org/licenses/by/4.0/legalcode

<span class="o">(</span>Optional<span class="o">)</span> switch shell <span class="k">for </span>weston to ivi-shell and start demo apps <span class="k">if </span>you want to start demo apps with ivi-shell.
<span class="gp">$ </span><span class="nb">cd</span> /opt/AGL/CES2016
<span class="gp">$ </span>./switch_to_ivi-shell
<span class="o">(</span>Option a<span class="o">)</span> <span class="nv">$ </span>./start_CES2016_ivi-shell.sh
<span class="o">(</span>Option b<span class="o">)</span> <span class="nv">$ </span>./start_CES2016_with_navi_ivi-shell.sh

Option a: start QML UI only.
Option b: start QML + CarNavigation:/home/navi. For the <span class="nb">time </span>being, CarNavigation expects to be Wayland native application, which will be showed on top of QML by using LayerManagerControl.
</code></pre>
</div>

<h3 id="more-documentation">More Documentation</h3>

<p>More documents, provide by <a href="http://iot.bzh/">Iot.bzh</a>, are available to guide developers with AGL and Renesas boards:</p>

<ul>
  <li><a href="http://iot.bzh/download/public/2016/sdk/AGL-Devkit-Image-and-SDK-for-porter.pdf">AGL-Devkit-Image-and-SDK-for-porter.pdf</a></li>
</ul>

<p>Detailed guide on how to build AGL for Renesas boards and using AGL SDK inside a ready-to-use Docker container.</p>

<ul>
  <li><a href="http://iot.bzh/download/public/2016/sdk/AGL-Devkit-Build-your-1st-AGL-Application.pdf">AGL-Devkit-Build-your-1st-AGL-Application.pdf</a></li>
</ul>

<p>Generic guide on how to build various application types (HTML5, native, Qt, QML, …) for AGL.</p>

<ul>
  <li><a href="http://iot.bzh/download/public/2016/bsp/AGL_Phase2-Devkit-HowTo_bake_a_service.pdf">AGL-Devkit-HowTo_bake_a_service.pdf</a></li>
</ul>

<p>Generic guide on how to add a new service in the BSP.</p>




                </div>
            </div>
        </div>
        <div class="row">
            <div class="blue-divider"></div>
<footer>
    <div class="container-fluid">
        <div class="row">
    <div class="col-sm-9">
        <h1>More Resources</h1>
        <div class="row">
            <div class="col-sm-4">
                <h2>General</h2>
                <ul class="nav">
                    <li>
                        <a target="_blank" href="https://www.automotivelinux.org/">AGL Developer Community</a>
                    </li>
                    <li>
                        <a href="https://www.automotivelinux.org/software/download/">Download Distribution</a>
                    </li>
                    <li>
                        <a href="https://gerrit.automotivelinux.org/gerrit/#/admin/projects/">Source Code on Git</a>
                    </li>
                    <li>
                        <a target="_blank" href="/contact">Mailing List</a>
                    </li>
                </ul>
            </div>
            <div class="col-sm-4">
                <h2>Development</h2>
                <ul class="nav">
                    <li><a target="_blank" href="https://wiki.automotivelinux.org/agl-distro/source-code">Source Code</a></li>
                    <li><a target="_blank" href="https://jira.automotivelinux.org/browse/SPEC/?selectedTab=com.atlassian.jira.jira-projects-plugin:summary-panel">Issue Tracker</a></li>
                    <li><a target="_blank" href="https://wiki.automotivelinux.org/">Wiki</a></li>
                    <li><a href="https://www.automotivelinux.org/contact-us">Contact</a></li>
                </ul>
            </div>
            <div class="col-sm-4">
                <h2>Automotive Grade Linux @ Linux Foundation</h2>
                <ul class="nav">
                    <li>
                        <a target="_blank" href="https://www.automotivelinux.org/">About AGL</a>
                    </li>
                    <li>
                        <a target="_blank" href="http://www.linuxfoundation.org/">About Linux Foundation</a>
                    </li>
                    <li>
                        <a target="_blank" href="https://wiki.automotivelinux.org/start/getting-started">Join AGL community</a>
                    </li>
                    <li>
                        <a target="_blank" href="https://www.automotivelinux.org/about/members">Members</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="col-sm-3">
        <h1>Contribute</h1>
        <p style="padding-top:20px"><strong>Help AGL move forward!</strong></p>
        <p>Report bugs, improve the docs, or contribute to the code.</p>
        <a href="/contribute" class="btn btn-lg btn-primary">
            Learn More
        </a>
        <p style="padding-top:20px"> <a href="https://twitter.com/autogradelinux" class="twitter-follow-button" data-show-count="false">Follow @autogradelinux</a></p>
    </div>
</div>
<div class="row">
	<div class="col-sm-9">
		<p class="copyright_text">
			Copyright &copy; 2015-2018 Automotive Grade Linux Documentation, Licensed under the <a target="_blank" href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
			<br/>
			Automotive Grade Linux and logos are <a target="_blank" href="http://www.linuxfoundation.org">trademarks</a> of The Linux Foundation.
			<br/>
			Initial site design from <a href="https://cordova.apache.org/">Cordova website.</a> - warm thanks !
		</p>
	</div>
    <div class="col-sm-3">
		<small class="stats">Page rendered at:  2018-06-01 00:02:45 +0000</small>
		
		<br/><small class="stats"><a href="https://raw.githubusercontent.com/automotive-grade-linux/docs-agl/master/docs/getting-started/machines/porter.md">Link to source document</small>
		
	</div>
</div>

    </div>
</footer>

        </div>
    </div>
</div>

<script defer type="text/javascript" src="/static/js/lib/toc.min.js"></script>
<script defer type="text/javascript" src="/static/js/docs.js"></script>

    <script defer type="text/javascript" src="/static/js/twitter.js"></script>
    



<script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
<script type="text/javascript">
    docsearch({
        apiKey: 'edd30bcff9f6df4b095c41cba3e5a418',
        indexName: 'automotivelinux',
        inputSelector: '#header-search-field',
    });
</script>

            
    

</body>
</html>
